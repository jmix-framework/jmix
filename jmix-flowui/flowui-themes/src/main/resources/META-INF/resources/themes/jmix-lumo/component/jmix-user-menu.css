/*
 * Copyright 2025 Haulmont.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

vaadin-menu-bar[jmix-role='jmix-user-menu'] vaadin-menu-bar-button.jmix-user-menu-button {
    padding: 0;
    min-width: var(--lumo-button-size);
    height: auto;
}

vaadin-menu-bar[jmix-role='jmix-user-menu'] vaadin-menu-bar-button.jmix-user-menu-button::part(label) {
    padding: 0;
}

vaadin-menu-bar[jmix-role='jmix-user-menu'] vaadin-menu-bar-item.jmix-user-menu-button {
    padding: 0;
    margin: 0;

    height: 100%;
}

/* Overlay */

vaadin-menu-bar-overlay.jmix-user-menu-overlay vaadin-menu-bar-item::part(content) {
    display: flex;
    align-items: center;
    gap: var(--lumo-space-s);
}

vaadin-menu-bar-overlay.jmix-user-menu-overlay vaadin-menu-bar-item::part(checkmark):before {
    color: inherit;
}

vaadin-menu-bar-overlay.jmix-user-menu-overlay vaadin-menu-bar-item[theme~='non-checkable'] {
    padding-inline-start: var(--lumo-space-s);
}

vaadin-menu-bar-overlay.jmix-user-menu-overlay vaadin-menu-bar-item[theme~='non-checkable']::part(checkmark) {
    display: none;
}

/* Default Button Renderer */

.jmix-user-menu-button-content {
    display: flex;
    gap: var(--lumo-space-s);
    align-items: center;

    color: var(--lumo-body-text-color);

    padding: var(--lumo-space-xs) var(--lumo-space-s);
}

vaadin-menu-bar[jmix-role='jmix-user-menu'][theme~='substituted'] .jmix-user-menu-button-content {
    --jmix-user-menu-avatar-size: var(--vaadin-avatar-size, 64px);
    --jmix-user-menu-substituted-indicator-size: calc(var(--jmix-user-menu-avatar-size) / 4);
    --jmix-user-menu-substituted-indicator-border-size: var(--vaadin-focus-ring-width, 2px);
    --jmix-user-menu-substituted-indicator-posotion: 1px;
}

.jmix-user-menu-button-content-user-avatar-wrapper {
    display: flex;
    position: relative;
}

.jmix-user-menu-button-content-user-name {
    overflow: hidden;
    text-overflow: ellipsis;
}

vaadin-menu-bar[jmix-role='jmix-user-menu'][theme~='substituted'] .jmix-user-menu-button-content-user-avatar:before {
    content: '';

    position: absolute;
    inset-inline-end: calc(-1 * var(--jmix-user-menu-substituted-indicator-border-size) + var(--jmix-user-menu-substituted-indicator-posotion));
    bottom: calc(-1 * var(--jmix-user-menu-substituted-indicator-border-size) + var(--jmix-user-menu-substituted-indicator-posotion));
    z-index: 1;

    border-radius: 100%;

    width: calc(var(--jmix-user-menu-substituted-indicator-size) + var(--jmix-user-menu-substituted-indicator-border-size) * 2);
    height: calc(var(--jmix-user-menu-substituted-indicator-size) + var(--jmix-user-menu-substituted-indicator-border-size) * 2);

    background-color: var(--lumo-base-color);
}

vaadin-app-layout[primary-section='navbar'] vaadin-menu-bar[jmix-role='jmix-user-menu'][theme~='substituted'] .jmix-user-menu-button-content-user-avatar:before {
    background-image: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct));
}

vaadin-menu-bar[jmix-role='jmix-user-menu'][theme~='substituted'] .jmix-user-menu-button-content-user-avatar:after {
    content: '';

    position: absolute;
    inset-inline-end: var(--jmix-user-menu-substituted-indicator-posotion);
    bottom: var(--jmix-user-menu-substituted-indicator-posotion);
    z-index: 1;

    border-radius: 100%;

    width: var(--jmix-user-menu-substituted-indicator-size);
    height: var(--jmix-user-menu-substituted-indicator-size);

    background-color: var(--lumo-warning-color);
}
